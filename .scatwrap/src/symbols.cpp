<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>src/symbols.cpp</title>
</head>
<body>
<!-- BEGIN SCAT CODE -->
#include&#32;&quot;symbols.h&quot;<br>
<br>
#include&#32;&lt;cctype&gt;<br>
<br>
CppSymbolFinder::CppSymbolFinder(const&#32;std::string&#32;&amp;text)<br>
{<br>
&#32;&#32;&#32;&#32;//&#32;Разбиваем&#32;текст&#32;на&#32;строки&#32;(независимо&#32;от&#32;\r\n&#32;/&#32;\n)<br>
&#32;&#32;&#32;&#32;std::string&#32;current;<br>
&#32;&#32;&#32;&#32;current.reserve(80);<br>
<br>
&#32;&#32;&#32;&#32;for&#32;(char&#32;c&#32;:&#32;text)<br>
&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(c&#32;==&#32;'\n')<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;m_lines.push_back(current);<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;current.clear();<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;else&#32;if&#32;(c&#32;!=&#32;'\r')<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;current.push_back(c);<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;m_lines.push_back(current);<br>
<br>
&#32;&#32;&#32;&#32;tokenize(text);<br>
}<br>
<br>
bool&#32;CppSymbolFinder::is_ident_start(char&#32;c)<br>
{<br>
&#32;&#32;&#32;&#32;unsigned&#32;char&#32;uc&#32;=&#32;static_cast&lt;unsigned&#32;char&gt;(c);<br>
&#32;&#32;&#32;&#32;return&#32;std::isalpha(uc)&#32;||&#32;c&#32;==&#32;'_';<br>
}<br>
<br>
bool&#32;CppSymbolFinder::is_ident_char(char&#32;c)<br>
{<br>
&#32;&#32;&#32;&#32;unsigned&#32;char&#32;uc&#32;=&#32;static_cast&lt;unsigned&#32;char&gt;(c);<br>
&#32;&#32;&#32;&#32;return&#32;std::isalnum(uc)&#32;||&#32;c&#32;==&#32;'_';<br>
}<br>
<br>
void&#32;CppSymbolFinder::tokenize(const&#32;std::string&#32;&amp;text)<br>
{<br>
&#32;&#32;&#32;&#32;m_tokens.clear();<br>
<br>
&#32;&#32;&#32;&#32;bool&#32;in_block_comment&#32;=&#32;false;<br>
&#32;&#32;&#32;&#32;bool&#32;in_string&#32;=&#32;false;<br>
&#32;&#32;&#32;&#32;bool&#32;in_char&#32;=&#32;false;<br>
<br>
&#32;&#32;&#32;&#32;int&#32;line&#32;=&#32;0;<br>
&#32;&#32;&#32;&#32;const&#32;std::size_t&#32;n&#32;=&#32;text.size();<br>
<br>
&#32;&#32;&#32;&#32;for&#32;(std::size_t&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;n;)<br>
&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;char&#32;c&#32;=&#32;text[i];<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(c&#32;==&#32;'\n')<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++line;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++i;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(in_block_comment)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(c&#32;==&#32;'*'&#32;&amp;&amp;&#32;i&#32;+&#32;1&#32;&lt;&#32;n&#32;&amp;&amp;&#32;text[i&#32;+&#32;1]&#32;==&#32;'/')<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;in_block_comment&#32;=&#32;false;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;i&#32;+=&#32;2;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;else<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++i;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(in_string&#32;||&#32;in_char)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(c&#32;==&#32;'\\'&#32;&amp;&amp;&#32;i&#32;+&#32;1&#32;&lt;&#32;n)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;i&#32;+=&#32;2;&#32;//&#32;экранированный&#32;символ<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(in_string&#32;&amp;&amp;&#32;c&#32;==&#32;'&quot;')<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;in_string&#32;=&#32;false;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;else&#32;if&#32;(in_char&#32;&amp;&amp;&#32;c&#32;==&#32;'\'')<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;in_char&#32;=&#32;false;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++i;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Пробелы<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(c&#32;==&#32;'&#32;'&#32;||&#32;c&#32;==&#32;'\t'&#32;||&#32;c&#32;==&#32;'\r'&#32;||&#32;c&#32;==&#32;'\f'&#32;||&#32;c&#32;==&#32;'\v')<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++i;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Препроцессорная&#32;директива:&#32;пропускаем&#32;всю&#32;строку<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(c&#32;==&#32;'#'&#32;&amp;&amp;&#32;(i&#32;==&#32;0&#32;||&#32;text[i&#32;-&#32;1]&#32;==&#32;'\n'))<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;while&#32;(i&#32;&lt;&#32;n&#32;&amp;&amp;&#32;text[i]&#32;!=&#32;'\n')<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++i;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Однострочный&#32;комментарий&#32;//<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(c&#32;==&#32;'/'&#32;&amp;&amp;&#32;i&#32;+&#32;1&#32;&lt;&#32;n&#32;&amp;&amp;&#32;text[i&#32;+&#32;1]&#32;==&#32;'/')<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;while&#32;(i&#32;&lt;&#32;n&#32;&amp;&amp;&#32;text[i]&#32;!=&#32;'\n')<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++i;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Блочный&#32;комментарий&#32;/*&#32;...&#32;*/<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(c&#32;==&#32;'/'&#32;&amp;&amp;&#32;i&#32;+&#32;1&#32;&lt;&#32;n&#32;&amp;&amp;&#32;text[i&#32;+&#32;1]&#32;==&#32;'*')<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;in_block_comment&#32;=&#32;true;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;i&#32;+=&#32;2;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Строковый&#32;литерал<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(c&#32;==&#32;'&quot;')<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;in_string&#32;=&#32;true;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++i;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Символьный&#32;литерал<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(c&#32;==&#32;'\'')<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;in_char&#32;=&#32;true;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++i;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Идентификатор&#32;/&#32;ключевое&#32;слово<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(is_ident_start(c))<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::size_t&#32;start&#32;=&#32;i;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++i;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;while&#32;(i&#32;&lt;&#32;n&#32;&amp;&amp;&#32;is_ident_char(text[i]))<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++i;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::string&#32;ident&#32;=&#32;text.substr(start,&#32;i&#32;-&#32;start);<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;Token&#32;tok;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tok.text&#32;=&#32;ident;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tok.line&#32;=&#32;line;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(ident&#32;==&#32;&quot;class&quot;&#32;||&#32;ident&#32;==&#32;&quot;struct&quot;)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tok.kind&#32;=&#32;Token::Keyword;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;else<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tok.kind&#32;=&#32;Token::Identifier;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;m_tokens.push_back(std::move(tok));<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Двойное&#32;двоеточие&#32;::<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(c&#32;==&#32;':'&#32;&amp;&amp;&#32;i&#32;+&#32;1&#32;&lt;&#32;n&#32;&amp;&amp;&#32;text[i&#32;+&#32;1]&#32;==&#32;':')<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;Token&#32;tok;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tok.kind&#32;=&#32;Token::Symbol;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tok.text&#32;=&#32;&quot;::&quot;;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tok.line&#32;=&#32;line;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;m_tokens.push_back(std::move(tok));<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;i&#32;+=&#32;2;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Любой&#32;пунктуационный&#32;символ&#32;как&#32;отдельный&#32;токен<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(std::ispunct(static_cast&lt;unsigned&#32;char&gt;(c)))<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;Token&#32;tok;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tok.kind&#32;=&#32;Token::Symbol;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tok.text&#32;=&#32;std::string(1,&#32;c);<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;tok.line&#32;=&#32;line;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;m_tokens.push_back(std::move(tok));<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++i;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;На&#32;всякий&#32;случай:&#32;пропускаем&#32;остальные&#32;символы<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++i;<br>
&#32;&#32;&#32;&#32;}<br>
}<br>
<br>
bool&#32;CppSymbolFinder::find_class_internal(const&#32;std::string&#32;&amp;class_name,<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ClassRange&#32;&amp;out)&#32;const<br>
{<br>
&#32;&#32;&#32;&#32;const&#32;std::size_t&#32;n&#32;=&#32;m_tokens.size();<br>
<br>
&#32;&#32;&#32;&#32;for&#32;(std::size_t&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;n;&#32;++i)<br>
&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;const&#32;Token&#32;&amp;t&#32;=&#32;m_tokens[i];<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(t.kind&#32;!=&#32;Token::Keyword)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(t.text&#32;!=&#32;&quot;class&quot;&#32;&amp;&amp;&#32;t.text&#32;!=&#32;&quot;struct&quot;)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Ищем&#32;первое&#32;имя&#32;после&#32;class/struct<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::size_t&#32;j&#32;=&#32;i&#32;+&#32;1;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;while&#32;(j&#32;&lt;&#32;n&#32;&amp;&amp;&#32;m_tokens[j].kind&#32;!=&#32;Token::Identifier)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++j;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(j&#32;&gt;=&#32;n)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;break;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;const&#32;Token&#32;&amp;name_tok&#32;=&#32;m_tokens[j];<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(name_tok.text&#32;!=&#32;class_name)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Определение&#32;или&#32;forward-declaration?<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Смотрим&#32;только&#32;до&#32;первой&#32;';'&#32;или&#32;'{'&#32;после&#32;имени.<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::size_t&#32;k&#32;=&#32;j&#32;+&#32;1;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;bool&#32;saw_lbrace&#32;=&#32;false;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;for&#32;(;&#32;k&#32;&lt;&#32;n;&#32;++k)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;const&#32;Token&#32;&amp;tk&#32;=&#32;m_tokens[k];<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(tk.text&#32;==&#32;&quot;{&quot;)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;saw_lbrace&#32;=&#32;true;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;break;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(tk.text&#32;==&#32;&quot;;&quot;)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;forward-decl:&#32;встретили&#32;';'&#32;раньше&#32;'{'<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;break;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Если&#32;до&#32;';'&#32;так&#32;и&#32;не&#32;встретили&#32;'{',&#32;это&#32;forward-declaration.<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(!saw_lbrace)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Ищем&#32;соответствующую&#32;закрывающую&#32;'}'<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;int&#32;depth&#32;=&#32;1;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::size_t&#32;body_start&#32;=&#32;k;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::size_t&#32;body_end&#32;=&#32;k;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;for&#32;(std::size_t&#32;p&#32;=&#32;k&#32;+&#32;1;&#32;p&#32;&lt;&#32;n;&#32;++p)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;const&#32;Token&#32;&amp;tp&#32;=&#32;m_tokens[p];<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(tp.text&#32;==&#32;&quot;{&quot;)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++depth;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;else&#32;if&#32;(tp.text&#32;==&#32;&quot;}&quot;)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;--depth;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(depth&#32;==&#32;0)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;body_end&#32;=&#32;p;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Захватываем&#32;возможное&#32;';'&#32;после&#32;'}'&#32;(class&#32;Foo&#32;{...};)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::size_t&#32;q&#32;=&#32;p&#32;+&#32;1;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(q&#32;&lt;&#32;n&#32;&amp;&amp;&#32;m_tokens[q].text&#32;==&#32;&quot;;&quot;)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;body_end&#32;=&#32;q;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;out.region.start_line&#32;=&#32;t.line;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;out.region.end_line&#32;=&#32;m_tokens[body_end].line;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;out.body_start_token&#32;=&#32;body_start;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;out.body_end_token&#32;=&#32;body_end;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;return&#32;true;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;return&#32;false;<br>
}<br>
<br>
bool&#32;CppSymbolFinder::find_class(const&#32;std::string&#32;&amp;class_name,<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;Region&#32;&amp;out)&#32;const<br>
{<br>
&#32;&#32;&#32;&#32;ClassRange&#32;cr;<br>
&#32;&#32;&#32;&#32;if&#32;(!find_class_internal(class_name,&#32;cr))<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;return&#32;false;<br>
<br>
&#32;&#32;&#32;&#32;out&#32;=&#32;cr.region;<br>
&#32;&#32;&#32;&#32;return&#32;true;<br>
}<br>
<br>
bool&#32;CppSymbolFinder::find_method(const&#32;std::string&#32;&amp;class_name,<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;const&#32;std::string&#32;&amp;method_name,<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;Region&#32;&amp;out)&#32;const<br>
{<br>
&#32;&#32;&#32;&#32;ClassRange&#32;cr;<br>
&#32;&#32;&#32;&#32;if&#32;(!find_class_internal(class_name,&#32;cr))<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;return&#32;false;<br>
<br>
&#32;&#32;&#32;&#32;const&#32;std::size_t&#32;begin&#32;=&#32;cr.body_start_token&#32;+&#32;1;<br>
&#32;&#32;&#32;&#32;const&#32;std::size_t&#32;end&#32;=&#32;cr.body_end_token;<br>
&#32;&#32;&#32;&#32;const&#32;std::size_t&#32;n&#32;=&#32;m_tokens.size();<br>
<br>
&#32;&#32;&#32;&#32;if&#32;(begin&#32;&gt;=&#32;n&#32;||&#32;begin&#32;&gt;=&#32;end)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;return&#32;false;<br>
<br>
&#32;&#32;&#32;&#32;//&#32;Ищем&#32;внутри&#32;тела&#32;класса<br>
&#32;&#32;&#32;&#32;for&#32;(std::size_t&#32;i&#32;=&#32;begin;&#32;i&#32;&lt;&#32;end;&#32;++i)<br>
&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;const&#32;Token&#32;&amp;t&#32;=&#32;m_tokens[i];<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(t.kind&#32;!=&#32;Token::Identifier)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(t.text&#32;!=&#32;method_name)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;После&#32;имени&#32;должен&#32;идти&#32;'('<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::size_t&#32;j&#32;=&#32;i&#32;+&#32;1;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(j&#32;&gt;=&#32;end&#32;||&#32;m_tokens[j].text&#32;!=&#32;&quot;(&quot;)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Определяем&#32;начало&#32;объявления:<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;идём&#32;назад&#32;до&#32;ближайшего&#32;';',&#32;'{'&#32;или&#32;'}'.<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::size_t&#32;start_tok&#32;=&#32;begin;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;for&#32;(std::size_t&#32;k&#32;=&#32;i;&#32;k&#32;&gt;&#32;begin;&#32;--k)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;const&#32;std::string&#32;&amp;s&#32;=&#32;m_tokens[k].text;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(s&#32;==&#32;&quot;;&quot;&#32;||&#32;s&#32;==&#32;&quot;{&quot;&#32;||&#32;s&#32;==&#32;&quot;}&quot;)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;start_tok&#32;=&#32;k&#32;+&#32;1;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;break;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;1)&#32;Пропускаем&#32;параметры&#32;(балансируем&#32;скобки)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::size_t&#32;pos&#32;=&#32;j;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;int&#32;paren_depth&#32;=&#32;0;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;for&#32;(;&#32;pos&#32;&lt;&#32;end;&#32;++pos)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;const&#32;std::string&#32;&amp;s&#32;=&#32;m_tokens[pos].text;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(s&#32;==&#32;&quot;(&quot;)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++paren_depth;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;else&#32;if&#32;(s&#32;==&#32;&quot;)&quot;)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;--paren_depth;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(paren_depth&#32;==&#32;0)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++pos;&#32;//&#32;идём&#32;на&#32;токен&#32;после&#32;')'<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;break;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(paren_depth&#32;!=&#32;0)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;&#32;//&#32;сломанная&#32;сигнатура<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;2)&#32;Ищем&#32;';'&#32;или&#32;'{'&#32;(начало&#32;тела)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;std::size_t&#32;end_tok&#32;=&#32;start_tok;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;int&#32;brace_depth&#32;=&#32;0;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;for&#32;(;&#32;pos&#32;&lt;&#32;end;&#32;++pos)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;const&#32;std::string&#32;&amp;s&#32;=&#32;m_tokens[pos].text;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(s&#32;==&#32;&quot;;&quot;)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;end_tok&#32;=&#32;pos;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;break;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(s&#32;==&#32;&quot;{&quot;)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;brace_depth&#32;=&#32;1;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;end_tok&#32;=&#32;pos;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++pos;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;for&#32;(;&#32;pos&#32;&lt;&#32;end;&#32;++pos)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;const&#32;std::string&#32;&amp;sb&#32;=&#32;m_tokens[pos].text;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(sb&#32;==&#32;&quot;{&quot;)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;++brace_depth;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;else&#32;if&#32;(sb&#32;==&#32;&quot;}&quot;)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;--brace_depth;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(brace_depth&#32;==&#32;0)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;{<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;end_tok&#32;=&#32;pos;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;break;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;break;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;if&#32;(end_tok&#32;&lt;&#32;start_tok)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;continue;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;int&#32;start_line_token&#32;=&#32;m_tokens[start_tok].line;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;int&#32;method_line&#32;=&#32;t.line;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;//&#32;Не&#32;вываливаемся&#32;на&#32;строку&#32;с&#32;access-specifier'ом&#32;(public:)<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;out.start_line&#32;=<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;(start_line_token&#32;&lt;&#32;method_line)&#32;?&#32;method_line&#32;:&#32;start_line_token;<br>
<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;out.end_line&#32;=&#32;m_tokens[end_tok].line;<br>
&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;return&#32;true;<br>
&#32;&#32;&#32;&#32;}<br>
<br>
&#32;&#32;&#32;&#32;return&#32;false;<br>
}<br>
<!-- END SCAT CODE -->
</body>
</html>
